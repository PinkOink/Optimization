\include{settings}
\usepackage{amsmath}

\begin{document}	% начало документа

% Титульная страница
\include{titlepage}

% Содержание
\renewcommand\contentsname{\centerline{Содержание}}
\tableofcontents
\newpage

\section{Постановка задачи}
Дана транспортная задача:
\begin{equation*}
\min_x \sum_{i=1}^4 \sum_{j=1}^5 c_{ij} x_{ij}
\end{equation*}
\begin{table}[!ht]
	\centering
		\begin{tabular} {|c|c|c|c|c|c|c|}
			\hline
			 & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $B_5$ & \\ \hline
			$A_1$ & 7 & 9 & 5 & 12 & 11 & 37 \\ \hline
			$A_2$ & 9 & 11 & 21 & 2 & 4 & 15 \\ \hline
			$A_3$ & 12 & 7 & 9 & 19 & 13 & 25 \\ \hline
			$A_4$ & 3 & 1 & 2 & 5 & 15 & 27 \\ \hline
			 & 27 & 35 & 12 & 14 & 16 & \\ \hline
		\end{tabular}
\end{table}
\begin{itemize}
	\item Необходимо решить ее методом потенциалов с выбором начального приближения методом северо-западного угла и методом минимального элемента.
	\item Решить задачу симплекс-методом и сравнить полученные результаты.
	\item Решить задачу с усложнением: запрет на поставку (максимум, 3 условия). Усложнение реализовать изменением исходной таблицы, а не изменением алгоритма.
\end{itemize}


\section{Описание алгоритма}
\subsection{Приведение задачи к закрытому типу}
Для того, чтобы транспортная задача имела допустимое решение необходимо и достаточно, чтобы выполнялось условие баланса:
\begin{equation*}
\sum_{i=1}^m a_i = \sum_{j=1}^n b_j
\end{equation*}
\\
Если условие баланса не выполняется, можно привести задачу к закрытому типу введением фиктивного поставщика или потребителя.
\begin{itemize}
	\item Пусть $\sum_{i=1}^m a_i > \sum_{j=1}^n b_j$. Тогда введем фикитивного потребителя $B_{n+1}$ спрос которого будет равен $b_{n+1}= \sum_{i=1}^m a_i - \sum_{j=1}^n b_j$. Транспортные затраты к этому потребителю будут равны 0. Тогда таблица примет вид:
	\begin{table}[!ht]
	\centering
		\begin{tabular} {|c|c|c|c|c|c|}
			\hline
			 & $B_1$ & ... & $B_n$ & $B_{n+1}$ & \\ \hline
			$A_1$ & $c_{11}$ & ... & $c_{1n}$ & 0 & $a_1$ \\ \hline
			$...$ & ... & ... & ... & ... & ... \\ \hline
			$A_m$ & $c_{m1}$ & ... & $c_{mn}$ & 0 & $a_m$ \\ \hline
			 & $b_1$ & ... & $b_n$ & $b_{n+1}$ & \\ \hline
		\end{tabular}
\end{table}
	\item Пусть $\sum_{j=1}^n b_j > \sum_{i=1}^m a_i$. Тогда введем фикитивного поставщика $A_{m+1}$ спрос которого будет равен $a_{m+1}= \sum_{j=1}^n b_j - \sum_{i=1}^m a_i$. Транспортные затраты от этого поставщика будут равны 0. Тогда таблица примет вид:
	\begin{table}[!ht]
	\centering
		\begin{tabular} {|c|c|c|c|c|}
			\hline
			 & $B_1$ & ... & $B_n$ & \\ \hline
			$A_1$ & $c_{11}$ & ... & $c_{1n}$ & $a_1$ \\ \hline
			$...$ & ... & ... & ... & ...  \\ \hline
			$A_m$ & $c_{m1}$ & ... & $c_{mn}$ &  $a_m$ \\ \hline
			$A_{m+1}$ & 0 & ... & 0 &  $a_{m+1}$ \\ \hline
			 & $b_1$ & ... & $b_n$ & \\ \hline
		\end{tabular}
\end{table}
\end{itemize}


\subsection{Метод потенциалов}
\subsubsection{Описание алгоритма}
Пусть $X=\{x_{ij}\}$ - начальный опорный план, построенный методом северо-западного угла или методом минимального элемента
\begin{enumerate}
	\item	Построим $S=\{(i,j)\}$ - множество индексов непустых клеток плана $X$
	
	\item Составим систему уравнений (потенциалов):
	\begin{equation*} 
	v_j-u_i=c_{ij}, (i,j)\in S
	\end{equation*}
	Полагаем $u_1=0$ и решаем систему следующим образом: рассмотрим $(u,v;S,c)$ как взвешенный граф с вершинами $u,v$, ребрами $S$ и весами ребер $c$. Обойдем этот граф вглубь, начиная с вершины $u_1$, которую кладем на стек. Снимаем вершину со стека. В каждой смежной вершине текущей рассматриваемой вершины запишем число, получаемое из равенства $v_j-u_i=c_{ij}$. Отметим все смежные вершины, как пройденные, и положим их на стек. Повторяем процесс, пока стек не будет исчерпан. Таким образом, система уравнений будет решена
	
	\item Проверим оптимальность плана \\
	Если $\Delta_{ij}=c_{ij}-(v_j-u_i)\geq0$ для всех $j=\overline{1,n}$, $i=\overline{1,m}$, то план оптимален. Алгоритм заканчивает работу\\
	Иначе находим позицию элемента $\Delta_{sr}=\min \delta_{ij} < 0$
	
	\item Пострим новый план \\
	Для это надо ввести новую переменную $x_{sr}$ в план. Добавим в граф (т.е. в множество $S$) новое ребро $(s,r)$. Найдем поиском в глубину цикл в графе, начиная с вершины $u_s$ (или $v_r$) \\
	Пусть $P$ - последовательность ребер цикла, которая начинается с $(s,r)$. Далее произведем пересчет плана:
	\begin{itemize}
		\item Помечаем поочередно элементы $P$ знаками + и -, начиная с плюса (у $(s,r)$ знак +)
		
		\item Соотнесем элементы-индексы из $P$ с клетками плана $X$. Найдем среди клеток, помеченных знаком -, минимальный элемент. Пусть он равен $x_{fg}$
		
		\item К клеткам плана $X$, отмеченным знаком +, прибавим значение клетки на позиции $(f,g)$
		
		\item Из клеток плана $X$, отмеченных знаком -, вычтем значение клетки на позиции $(f,g)$
		
		\item Исключим из множества непустых клеток плана $X$ клетку с индексом $(f,g)$ и добавим клетку с индексом $(s,r)$
	\end{itemize}
	
	\item Вернемся к шагу 1
	
\end{enumerate}

\subsubsection{Метод северо-западного угла}
Начинаем заполнение матрицы $X$ с северо-западного элемента таблицы $x_{11}=min\{a_1,b_1\}$, который будет первым базисным элементом (непустая клетка таблицы). Корректируем значения спроса и предложения в копиях соответствующих столбцов: $\overline{a_1}=a_1-x_{11}$, $\overline{b_1}=b_1-x_{11}$. \\
Если оказалось, что обнулилось $\overline{b_1}$, то следующим рассматриваемым элементом становится $x_{12}$, т.е. элемент правее. Иначе выбираем элемент $x_{21}$, т.е. ниже. Если обнулилось $\overline{a_1}$, то все равно выбираем элемент ниже. Затем, повторяем процесс, пока так не заполним $n+m-1$ базисный непустой элемент. \\
Для полученного решения будем считать, что пустые элементы $X$ равны 0.

\subsubsection{Метод минимального элемента}
Метод использует тот же принцип, что и метод северо-западного угла. Отличие состоит в том, что текущим рассматриваемым элементом на каждой итерации выбирается свободный (пустой) элемент матрицы $X$, имеющий наименьшие затраты в соответствующей позиции матрицы $c$ среди свободных элементов.

\subsection{Построение двойственной задачи}
Каноническая закрытая транспортная задача выглядит так:
\begin{align*}
& \min_x \sum_{i=1}^m \sum_{j=1}^n c_{ij} x_{ij} \\ 
& \sum_{j=1}^n x_{ij} = a_i, i=\overline{1,m} \\
& \sum_{i=1}^m x_{ij} = b_j, i=\overline{1,n} \\
& x_{ij} \geq 0
\end{align*} 
Двойственная задача будет иметь следующий вид:
\begin{align*}
& \max_{u,v} \sum_{j=1}^n b_j v_j - \sum_{i=1}^m a_i u_i \\ 
& v_j - u_i \leq c_{ij}, i=\overline{1,m}, j=\overline{1,n}
\end{align*} 

\subsection{Решение транспортной задачи симплекс-методом}
Транспортная задача является задачей ЛП, поэтому ее можно привести к каноническому виду и решить симплекс-методом. \\
Получим задачу следующего вида:\\
\begin{align*}
	\min_{\overline{x}} &\; \overline{c}^T \overline{x} \\
	\overline{A}\overline{x} &=\overline{b} \\
	\overline{A} &=\begin{pmatrix} 
			1 & ... & 1 & 0 & ... & 0 & ... & 0 & ... & 0 \\
			0 & ... & 0 & 1 & ... & 1 & ... & 0 & ... & 0 \\
			... & ... & ... & ... & ... & ... & ... & ... & ... & ... \\
			0 & ... & 0 & 0 & ... & 0 & ... & 1 & ... & 1 \\ \hline
			1 & ... & 0 & 1 & ... & 0 & ... & 1 & ... & 0 \\
			... & ... & ... & ... & ... & ... & ... & ... & ... & ... \\
			0 & ... & 1 & 0 & ... & 1 & ... & 0 & ... & 1 \\
		\end{pmatrix} \\
	\overline{b}^T &= \begin{pmatrix} a^T & b^T \end{pmatrix} \\
	\overline{c}^T &= \begin{pmatrix} c_{11} & ... & c_{1n} & c_{21} & ... & c_{2n} & ... & c_{m1} & ... & c_{mn} \end{pmatrix} \\
	\overline{x}^T &= \begin{pmatrix} x_{11} & ... & x_{1n} & x_{21} & ... & x_{2n} & ... & x_{m1} & ... & x_{mn} \end{pmatrix}
\end{align*}
В матрице $\overline{A}$ нет линейной независимости, поэтому можно убрать 1 любую строчку (например, последнюю). Тогда ее ранг будет $m+n-1$. \\
Полученную задачу решаем симплекс-методом.

\subsection{Запрет на поставку}
Пусть задано множество пар $S=\{(i,j)\}$ таких, что от $i$-го поставщика нельзя везти товар $j$-му потребителю. \\
Для учитывания этого запрета можно изменить условия задачи, не меняя алгоритм решения. Заменим в матрице тарифов $C$ все элементы с индексами из $S$ на очень большое число $M$. Можно взять $M=\infty$. Но если в реализации алгоритма с бесконечностью могут возникнуть проблемы, то можно взять $M>\max_{c_{ij}\in C} c_{ij} \ast \sum_{i=1}^m a_i$.


\section{Исследование применимости метода}
Проверим условие баланса задачи:
\begin{align*}
\sum_{i=1}^m a_i &= 37 + 15 + 25 + 27 = 104 \\
\sum_{j=1}^n b_j &=27+35+12+14+16 = 104
\end{align*} 
Условие выполняется, задача закрытого типа, можно применять метод потенциалов.


\section{Результаты решения}
\subsection{Задача без запретов}
\subsubsection{Метод потенциалов. Метод северо-западного угла}
Найдем начальный опорный план методом северо-западного угла. Получим план:
\begin{align*}
	X_0 &=
		\begin{pmatrix} 
			27 & 10 & 0 & 0 & 0 \\ 
			0 & 15 & 0 & 0 & 0 \\ 
			0 & 10 & 12 & 3 & 0 \\ 
			0 & 0 & 0 & 11 & 16
		\end{pmatrix} \\
	X_{used} &=
		\begin{pmatrix} 
			T & T & F & F & F \\ 
			F & T & F & F & F \\ 
			F & T & T & T & F \\ 
			F & F & F & T & T
		\end{pmatrix} \\
\end{align*}
где $X_{used}$ - матрица пустых/непустых клеток. $T$ - клетка в базисе, $F$ - клетка пустая. \\
С таким начальным приближением метод потенциалов выдаст следующий ответ:
\begin{align*}
	X &=
		\begin{pmatrix} 
			25 & 0 & 12 & 0 & 0 \\ 
			0 & 0 & 0 & 0 & 15 \\ 
			0 & 24 & 0 & 0 & 1 \\ 
			2 & 11 & 0 & 14 & 0
		\end{pmatrix} \\
	\sum_{i=1}^4 &\sum_{j=1}^5 c_{ij} x_{ij} = 563
\end{align*}

\subsubsection{Метод потенциалов. Метод минимального элемента}
Найдем начальный опорный план методом минимального элемента. Получим план:
\begin{align*}
	X_0 &=
		\begin{pmatrix} 
			25 & 0 & 12 & 0 & 0 \\ 
			0 & 0 & 0 & 14 & 1 \\ 
			2 & 8 & 0 & 0 & 15 \\ 
			0 & 27 & 0 & 0 & 0
		\end{pmatrix} \\
	X_{used} &=
		\begin{pmatrix} 
			T & F & T & F & F \\ 
			F & F & F & T & T \\ 
			T & T & F & F & T \\ 
			F & T & F & F & F
		\end{pmatrix} \\
\end{align*}
где $X_{used}$ - матрица пустых/непустых клеток. $T$ - клетка в базисе, $F$ - клетка пустая. \\
С таким начальным приближением метод потенциалов выдаст следующий ответ:
\begin{align*}
	X &=
		\begin{pmatrix} 
			25 & 0 & 12 & 0 & 0 \\ 
			0 & 0 & 0 & 14 & 1 \\ 
			0 & 10 & 0 & 0 & 15 \\ 
			2 & 25 & 0 & 0 & 0
		\end{pmatrix} \\
	\sum_{i=1}^4 &\sum_{j=1}^5 c_{ij} x_{ij} = 563
\end{align*}

\subsubsection{Симплекс-метод}
Приведем транспортную задачу к виду канонической задачи ЛП и решим симплекс-методом. Начальное приближение найдем методом искусственного базиса. Получим:
\begin{align*}
	X &=
		\begin{pmatrix} 
			10 & 0 & 12 & 0 & 15 \\ 
			0 & 0 & 0 & 14 & 1 \\ 
			0 & 25 & 0 & 0 & 0 \\ 
			17 & 10 & 0 & 0 & 0
		\end{pmatrix} \\
	\sum_{i=1}^4 &\sum_{j=1}^5 c_{ij} x_{ij} = 563
\end{align*}

\subsubsection{Двойственная задача}
Для проверки оптимальности полученных решений, решим двойственную задачу симплекс-методом. Получим:
\begin{equation*}
\max_{u,v} \sum_{j=1}^n b_j v_j - \sum_{i=1}^m a_i u_i = 563 
\end{equation*}

\subsection{Задача с запретами}
Введем запреты на те перевозки, которые были в каждом решении обычной транспортной задачи. Например, запретим $A_1 \rightarrow B_1$, $A_4 \rightarrow B_2$, $A_2 \rightarrow B_5$. Запишем в таблицу тарифов на этих позициях $\infty$. Получим задачу:
\begin{table}[!ht]
	\centering
		\begin{tabular} {|c|c|c|c|c|c|c|}
			\hline
			 & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $B_5$ & \\ \hline
			$A_1$ & $\infty$ & 9 & 5 & 12 & 11 & 37 \\ \hline
			$A_2$ & 9 & 11 & 21 & 2 & $\infty$ & 15 \\ \hline
			$A_3$ & 12 & 7 & 9 & 19 & 13 & 25 \\ \hline
			$A_4$ & 3 & $\infty$ & 2 & 5 & 15 & 27 \\ \hline
			 & 27 & 35 & 12 & 14 & 16 & \\ \hline
		\end{tabular}
\end{table}

\subsubsection{Метод потенциалов. Метод северо-западного угла}
Найдем начальный опорный план методом северо-западного угла. Получим план:
\begin{align*}
	X_0 &=
		\begin{pmatrix} 
			27 & 10 & 0 & 0 & 0 \\ 
			0 & 15 & 0 & 0 & 0 \\ 
			0 & 10 & 12 & 3 & 0 \\ 
			0 & 0 & 0 & 11 & 16
		\end{pmatrix} \\
	X_{used} &=
		\begin{pmatrix} 
			T & T & F & F & F \\ 
			F & T & F & F & F \\ 
			F & T & T & T & F \\ 
			F & F & F & T & T
		\end{pmatrix} \\
\end{align*}
где $X_{used}$ - матрица пустых/непустых клеток. $T$ - клетка в базисе, $F$ - клетка пустая. \\
С таким начальным приближением метод потенциалов выдаст следующий ответ:
\begin{align*}
	X &=
		\begin{pmatrix} 
			0 & 9 & 12 & 0 & 16 \\ 
			0 & 1 & 0 & 14 & 0 \\ 
			0 & 25 & 0 & 0 & 0 \\ 
			27 & 0 & 0 & 0 & 0
		\end{pmatrix} \\
	\sum_{i=1}^4 &\sum_{j=1}^5 c_{ij} x_{ij} = 612
\end{align*}

\subsubsection{Метод потенциалов. Метод минимального элемента}
Найдем начальный опорный план методом минимального элемента. Получим план:
\begin{align*}
	X_0 &=
		\begin{pmatrix} 
			11 & 10 & 0 & 0 & 16 \\ 
			1 & 0 & 0 & 14 & 0 \\ 
			0 & 25 & 0 & 0 & 0 \\ 
			15 & 0 & 12 & 0 & 0
		\end{pmatrix} \\
	X_{used} &=
		\begin{pmatrix} 
			T & T & F & F & T \\ 
			T & F & F & T & F \\ 
			F & T & F & F & F \\ 
			T & F & T & F & F
		\end{pmatrix} \\
\end{align*}
где $X_{used}$ - матрица пустых/непустых клеток. $T$ - клетка в базисе, $F$ - клетка пустая. \\
С таким начальным приближением метод потенциалов выдаст следующий ответ:
\begin{align*}
	X &=
		\begin{pmatrix} 
			0 & 9 & 12 & 0 & 16 \\ 
			0 & 1 & 0 & 14 & 0 \\ 
			0 & 25 & 0 & 0 & 0 \\ 
			27 & 0 & 0 & 0 & 0
		\end{pmatrix} \\
	\sum_{i=1}^4 &\sum_{j=1}^5 c_{ij} x_{ij} = 612
\end{align*}

\subsubsection{Симплекс-метод}
Приведем транспортную задачу к виду канонической задачи ЛП и решим симплекс-методом. Начальное приближение найдем методом искусственного базиса. Получим:
\begin{align*}
	X &=
		\begin{pmatrix} 
			0 & 9 & 12 & 0 & 16 \\ 
			0 & 1 & 0 & 14 & 0 \\ 
			0 & 25 & 0 & 0 & 0 \\ 
			27 & 0 & 0 & 0 & 0
		\end{pmatrix} \\
	\sum_{i=1}^4 &\sum_{j=1}^5 c_{ij} x_{ij} = 612
\end{align*}

\subsubsection{Двойственная задача}
Для проверки оптимальности полученных решений, решим двойственную задачу симплекс-методом. Получим:
\begin{equation*}
\max_{u,v} \sum_{j=1}^n b_j v_j - \sum_{i=1}^m a_i u_i = 612
\end{equation*}


\section{Обоснование достоверности полученного результата}
\underline{Теорема}\\
Для того, чтобы $\overline{x}[N]$ была оптимальной точкой в задаче ЛП в общем виде, необходимо и достаточно, чтобы $\exists \overline{y}[M]$ такой, что $ \overline{y}[M_1]\geq0$ и функция Лагранжа
\begin{equation*}
\psi(x,y)=c^T[N]x[N]+y^T[M](b[M]-A[M,N]x[N])
\end{equation*}
на множествах $x[N_1]\geq0$, $y[M_1]\geq0$ имела седловую точку $(\overline{x}[N],\overline{y}[M])$.\\
\\
Известно, что если значения функций основной задачи и двойственной в полученных допустимых точках совпали, то эти точки образуют седловую точку функции Лагранжа. Тогда по теореме допустимая точка основной задачи является точкой оптимума. \\
\\
Для транспортной задачи без запретов и для транспортной задачи с запретами значения функций в полученных решениях методом потенциалов, симплекс-методом и значения функций в решении двойственной задачи совпали. Значит, все полученные решения являются оптимальными.


\section{Анализ}
\subsection{Сравнение метода потенциалов и симплекс-метода}
Сравним, за сколько итераций каждый метод решил поставленную задачу. Получим: \\
\begin{table}[!ht]
	\centering
		\begin{tabular} {|c|c|c|c|c|}
			\hline
			 & МП. NW & МП. Min & Simplex & Dual \\ \hline
			 Без запретов & 7 & 1 & 12+6 & 22+5 \\ \hline
			 С запретами & 9 & 2 & 12+3 & 23+5 \\ \hline
		\end{tabular}
\end{table} \\
У симплекс-метода указаны 2 числа: количество итераций для нахождения начального приближения методом искусственного базиса и количество итераций решения самой задачи. \\
Из таблицы видно, что симплекс-метод решает задачу дольше метода потенциалов, так как он не учитывает специфику условий задачи. Как результат, в симплекс-методе задача ЛП в каноническом виде имеет большую размерность: $\text{dim}A=(8,28)$ у вспомогательной задачи метода искусственного базиса, $\text{dim}A=(8,20)$ у основной задачи. \\
При решении двойственной задачи размерность матрицы $A$ оказывается еще больше: $\text{dim}A=(20,58)$ у вспомогательной задачи метода искусственного базиса, $\text{dim}A=(20,38)$ у основной задачи. 

\subsection{Сравнение метода северо-западного угла и метода минимального элемента}
Сравним, насколько хорошо каждый метод находит начальное приближение. Для этого посмотрим, за сколько итераций (циклов пересчета) метод потенциалов решит задачу с начальным приближением, полученным каждым методов. Получим: \\
\begin{table}[!ht]
	\centering
		\begin{tabular} {|c|c|c|}
			\hline
			 & МП. NW & МП. Min \\ \hline
			 Без запретов & 7 & 1 \\ \hline
			 С запретами & 9 & 2 \\ \hline
		\end{tabular}
\end{table} \\
Из результатов видно, что метод минимального элемента дает начальное приближение, которое ближе к истинному оптимуму, чем начальное приближение метода северо-западного угла. Однако работает метод минимального элемента медленнее, так как для нахождения следующего вводимого базисного элемента ему нужно обойти всю свободную таблицу тарифов. Метод северо-западного угла в этом плане лучше.


\end{document}